<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Thanh toán dịch vụ</title>
</head>
<body>

<h2>Hóa đơn: <span th:text="${hoaDon.maHD}"></span></h2>
<p>Khách hàng: <span th:text="${hoaDon.khachHang.hoTen}"></span></p>
<p>Ngày lập hóa đơn: <span th:text="${hoaDon.ngayLap}"></span></p>
<p>Trạng thái: <span th:text="${hoaDon.trangThai}"></span></p>

<h3>Chi tiết các dịch vụ đã đăng ký:</h3>
<table border="1">
    <thead>
        <tr>
            <th>Tên dịch vụ</th>
            <th>Loại</th>
            <th>Đơn giá</th>
            <th>Ngày bắt đầu</th>
            <th>Ngày kết thúc</th>
            <th>Lớp</th>
            <th>Huấn luyện viên</th>
        </tr>
    </thead>
    <tbody>
        <tr th:each="ct : ${dsChiTiet}">
            <td th:text="${ct.dichVu.tenDV}">Tên</td>
            <td th:text="${ct.dichVu.loaiDV}">Loại</td>
            <td th:text="${ct.dichVu.donGia} + ' VNĐ'">Đơn giá</td>
            <td th:text="${#temporals.format(ct.ngayBD, 'dd/MM/yyyy')}">BD</td>
            <td th:text="${#temporals.format(ct.ngayKT, 'dd/MM/yyyy')}">KT</td>
            <td th:text="${ct.lop != null ? ct.lop.tenLop : 'Không'}">Lớp</td>
            <td th:text="${ct.nhanVien != null ? ct.nhanVien.tenNV : 'Không'}">HLV</td>
        </tr>
    </tbody>
</table>

<h3>Tổng tiền: <span th:text="${hoaDon.tongTien} + ' VNĐ'"></span></h3>

<div th:if="${hoaDon.trangThai.name() == 'ChuaThanhToan'}">
    <form method="post" th:action="@{/thanh-toan/{maHD}(maHD=${hoaDon.maHD})}">
        <button type="submit">Thanh toán</button>
    </form>
</div>

<div th:if="${hoaDon.trangThai.name() == 'DaThanhToan'}">
    <p style="color:green;">✅ Đã thanh toán</p>
</div>

</body>
</html>
